// Package openapi provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.5.1 DO NOT EDIT.
package openapi

import (
	"fmt"
	"net/http"

	"github.com/gin-gonic/gin"
	"github.com/oapi-codegen/runtime"
	openapi_types "github.com/oapi-codegen/runtime/types"
)

const (
	BearerAuthScopes = "bearerAuth.Scopes"
)

// Defines values for CreatePatientRequestGender.
const (
	CreatePatientRequestGenderFEMALE  CreatePatientRequestGender = "FEMALE"
	CreatePatientRequestGenderMALE    CreatePatientRequestGender = "MALE"
	CreatePatientRequestGenderOTHER   CreatePatientRequestGender = "OTHER"
	CreatePatientRequestGenderUNKNOWN CreatePatientRequestGender = "UNKNOWN"
)

// Defines values for CreatePatientRequestRace.
const (
	CreatePatientRequestRaceASIAN      CreatePatientRequestRace = "ASIAN"
	CreatePatientRequestRaceBLACK      CreatePatientRequestRace = "BLACK"
	CreatePatientRequestRaceINDIGENOUS CreatePatientRequestRace = "INDIGENOUS"
	CreatePatientRequestRaceMIXED      CreatePatientRequestRace = "MIXED"
	CreatePatientRequestRaceUNKNOWN    CreatePatientRequestRace = "UNKNOWN"
	CreatePatientRequestRaceWHITE      CreatePatientRequestRace = "WHITE"
)

// Defines values for GetV1PatientsIdLabsParamsExpand.
const (
	Full GetV1PatientsIdLabsParamsExpand = "full"
)

// CreatePatientRequest defines model for CreatePatientRequest.
type CreatePatientRequest struct {
	AvatarUrl *string                    `json:"avatar_url,omitempty"`
	BirthDate openapi_types.Date         `json:"birth_date"`
	Cpf       string                     `json:"cpf"`
	FullName  string                     `json:"full_name"`
	Gender    CreatePatientRequestGender `json:"gender"`
	Phone     *string                    `json:"phone"`
	Race      CreatePatientRequestRace   `json:"race"`
}

// CreatePatientRequestGender defines model for CreatePatientRequest.Gender.
type CreatePatientRequestGender string

// CreatePatientRequestRace defines model for CreatePatientRequest.Race.
type CreatePatientRequestRace string

// CreateUserRequest defines model for CreateUserRequest.
type CreateUserRequest struct {
	BirthDate openapi_types.Date `json:"birth_date"`
	Cpf       string             `json:"cpf"`
	FullName  string             `json:"full_name"`
	Phone     string             `json:"phone"`
}

// ErrorResponse defines model for ErrorResponse.
type ErrorResponse struct {
	Error struct {
		Code    *string `json:"code,omitempty"`
		Message *string `json:"message,omitempty"`
	} `json:"error"`
}

// HealthResponse defines model for HealthResponse.
type HealthResponse struct {
	Status string `json:"status"`
}

// LabUploadResponse Retorno do processamento do laudo.
type LabUploadResponse map[string]interface{}

// LabsList defines model for LabsList.
type LabsList = []map[string]interface{}

// Patient Representação simplificada do paciente.
type Patient map[string]interface{}

// PatientCreatedResponse defines model for PatientCreatedResponse.
type PatientCreatedResponse struct {
	Id openapi_types.UUID `json:"id"`
}

// PatientsList defines model for PatientsList.
type PatientsList = []Patient

// RootResponse defines model for RootResponse.
type RootResponse struct {
	Docs        string `json:"docs"`
	Environment string `json:"environment"`
	Health      string `json:"health"`
	Name        string `json:"name"`
	Openapi     string `json:"openapi"`
	Ready       string `json:"ready"`
	Version     string `json:"version"`
}

// UpdateUserRequest defines model for UpdateUserRequest.
type UpdateUserRequest struct {
	BirthDate *openapi_types.Date `json:"birth_date"`
	Cpf       *string             `json:"cpf"`
	FullName  *string             `json:"full_name"`
	Phone     *string             `json:"phone"`
}

// User Representação simplificada do usuário.
type User map[string]interface{}

// LimitParam defines model for LimitParam.
type LimitParam = int

// OffsetParam defines model for OffsetParam.
type OffsetParam = int

// AppError defines model for AppError.
type AppError = ErrorResponse

// GetV1MePatientsParams defines parameters for GetV1MePatients.
type GetV1MePatientsParams struct {
	// Limit Número máximo de itens
	Limit *LimitParam `form:"limit,omitempty" json:"limit,omitempty"`

	// Offset Número de itens para pular
	Offset *OffsetParam `form:"offset,omitempty" json:"offset,omitempty"`
}

// GetV1PatientsIdLabsParams defines parameters for GetV1PatientsIdLabs.
type GetV1PatientsIdLabsParams struct {
	// Expand Retorna a representação completa quando expand=full
	Expand *GetV1PatientsIdLabsParamsExpand `form:"expand,omitempty" json:"expand,omitempty"`

	// Include Lista de campos para expandir (ex.: results)
	Include *string `form:"include,omitempty" json:"include,omitempty"`

	// Limit Número máximo de itens
	Limit *LimitParam `form:"limit,omitempty" json:"limit,omitempty"`

	// Offset Número de itens para pular
	Offset *OffsetParam `form:"offset,omitempty" json:"offset,omitempty"`
}

// GetV1PatientsIdLabsParamsExpand defines parameters for GetV1PatientsIdLabs.
type GetV1PatientsIdLabsParamsExpand string

// PostV1PatientsIdLabsMultipartBody defines parameters for PostV1PatientsIdLabs.
type PostV1PatientsIdLabsMultipartBody struct {
	File openapi_types.File `json:"file"`
}

// PutV1MeJSONRequestBody defines body for PutV1Me for application/json ContentType.
type PutV1MeJSONRequestBody = UpdateUserRequest

// PostV1PatientsJSONRequestBody defines body for PostV1Patients for application/json ContentType.
type PostV1PatientsJSONRequestBody = CreatePatientRequest

// PostV1PatientsIdLabsMultipartRequestBody defines body for PostV1PatientsIdLabs for multipart/form-data ContentType.
type PostV1PatientsIdLabsMultipartRequestBody PostV1PatientsIdLabsMultipartBody

// PostV1UsersJSONRequestBody defines body for PostV1Users for application/json ContentType.
type PostV1UsersJSONRequestBody = CreateUserRequest

// ServerInterface represents all server handlers.
type ServerInterface interface {
	// API metadata
	// (GET /)
	Get(c *gin.Context)
	// API docs (Redoc)
	// (GET /docs)
	GetDocs(c *gin.Context)
	// Health check
	// (GET /healthz)
	GetHealthz(c *gin.Context)
	// Readiness check
	// (GET /readyz)
	GetReadyz(c *gin.Context)
	// Remover usuário atual (hard delete)
	// (DELETE /v1/me)
	DeleteV1Me(c *gin.Context)
	// Obter perfil do usuário atual
	// (GET /v1/me)
	GetV1Me(c *gin.Context)
	// Atualizar perfil do usuário atual
	// (PUT /v1/me)
	PutV1Me(c *gin.Context)
	// Listar pacientes do usuário atual
	// (GET /v1/me/patients)
	GetV1MePatients(c *gin.Context, params GetV1MePatientsParams)
	// Listar pacientes
	// (GET /v1/patients)
	GetV1Patients(c *gin.Context)
	// Criar paciente
	// (POST /v1/patients)
	PostV1Patients(c *gin.Context)
	// Obter paciente
	// (GET /v1/patients/{id})
	GetV1PatientsId(c *gin.Context, id openapi_types.UUID)
	// Listar laudos
	// (GET /v1/patients/{id}/labs)
	GetV1PatientsIdLabs(c *gin.Context, id openapi_types.UUID, params GetV1PatientsIdLabsParams)
	// Upload de laudo
	// (POST /v1/patients/{id}/labs)
	PostV1PatientsIdLabs(c *gin.Context, id openapi_types.UUID)
	// Criar usuário
	// (POST /v1/users)
	PostV1Users(c *gin.Context)
}

// ServerInterfaceWrapper converts contexts to parameters.
type ServerInterfaceWrapper struct {
	Handler            ServerInterface
	HandlerMiddlewares []MiddlewareFunc
	ErrorHandler       func(*gin.Context, error, int)
}

type MiddlewareFunc func(c *gin.Context)

// Get operation middleware
func (siw *ServerInterfaceWrapper) Get(c *gin.Context) {

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.Get(c)
}

// GetDocs operation middleware
func (siw *ServerInterfaceWrapper) GetDocs(c *gin.Context) {

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.GetDocs(c)
}

// GetHealthz operation middleware
func (siw *ServerInterfaceWrapper) GetHealthz(c *gin.Context) {

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.GetHealthz(c)
}

// GetReadyz operation middleware
func (siw *ServerInterfaceWrapper) GetReadyz(c *gin.Context) {

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.GetReadyz(c)
}

// DeleteV1Me operation middleware
func (siw *ServerInterfaceWrapper) DeleteV1Me(c *gin.Context) {

	c.Set(BearerAuthScopes, []string{})

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.DeleteV1Me(c)
}

// GetV1Me operation middleware
func (siw *ServerInterfaceWrapper) GetV1Me(c *gin.Context) {

	c.Set(BearerAuthScopes, []string{})

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.GetV1Me(c)
}

// PutV1Me operation middleware
func (siw *ServerInterfaceWrapper) PutV1Me(c *gin.Context) {

	c.Set(BearerAuthScopes, []string{})

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.PutV1Me(c)
}

// GetV1MePatients operation middleware
func (siw *ServerInterfaceWrapper) GetV1MePatients(c *gin.Context) {

	var err error

	c.Set(BearerAuthScopes, []string{})

	// Parameter object where we will unmarshal all parameters from the context
	var params GetV1MePatientsParams

	// ------------- Optional query parameter "limit" -------------

	err = runtime.BindQueryParameter("form", true, false, "limit", c.Request.URL.Query(), &params.Limit)
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter limit: %w", err), http.StatusBadRequest)
		return
	}

	// ------------- Optional query parameter "offset" -------------

	err = runtime.BindQueryParameter("form", true, false, "offset", c.Request.URL.Query(), &params.Offset)
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter offset: %w", err), http.StatusBadRequest)
		return
	}

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.GetV1MePatients(c, params)
}

// GetV1Patients operation middleware
func (siw *ServerInterfaceWrapper) GetV1Patients(c *gin.Context) {

	c.Set(BearerAuthScopes, []string{})

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.GetV1Patients(c)
}

// PostV1Patients operation middleware
func (siw *ServerInterfaceWrapper) PostV1Patients(c *gin.Context) {

	c.Set(BearerAuthScopes, []string{})

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.PostV1Patients(c)
}

// GetV1PatientsId operation middleware
func (siw *ServerInterfaceWrapper) GetV1PatientsId(c *gin.Context) {

	var err error

	// ------------- Path parameter "id" -------------
	var id openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "id", c.Param("id"), &id, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter id: %w", err), http.StatusBadRequest)
		return
	}

	c.Set(BearerAuthScopes, []string{})

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.GetV1PatientsId(c, id)
}

// GetV1PatientsIdLabs operation middleware
func (siw *ServerInterfaceWrapper) GetV1PatientsIdLabs(c *gin.Context) {

	var err error

	// ------------- Path parameter "id" -------------
	var id openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "id", c.Param("id"), &id, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter id: %w", err), http.StatusBadRequest)
		return
	}

	c.Set(BearerAuthScopes, []string{})

	// Parameter object where we will unmarshal all parameters from the context
	var params GetV1PatientsIdLabsParams

	// ------------- Optional query parameter "expand" -------------

	err = runtime.BindQueryParameter("form", true, false, "expand", c.Request.URL.Query(), &params.Expand)
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter expand: %w", err), http.StatusBadRequest)
		return
	}

	// ------------- Optional query parameter "include" -------------

	err = runtime.BindQueryParameter("form", true, false, "include", c.Request.URL.Query(), &params.Include)
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter include: %w", err), http.StatusBadRequest)
		return
	}

	// ------------- Optional query parameter "limit" -------------

	err = runtime.BindQueryParameter("form", true, false, "limit", c.Request.URL.Query(), &params.Limit)
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter limit: %w", err), http.StatusBadRequest)
		return
	}

	// ------------- Optional query parameter "offset" -------------

	err = runtime.BindQueryParameter("form", true, false, "offset", c.Request.URL.Query(), &params.Offset)
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter offset: %w", err), http.StatusBadRequest)
		return
	}

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.GetV1PatientsIdLabs(c, id, params)
}

// PostV1PatientsIdLabs operation middleware
func (siw *ServerInterfaceWrapper) PostV1PatientsIdLabs(c *gin.Context) {

	var err error

	// ------------- Path parameter "id" -------------
	var id openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "id", c.Param("id"), &id, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandler(c, fmt.Errorf("Invalid format for parameter id: %w", err), http.StatusBadRequest)
		return
	}

	c.Set(BearerAuthScopes, []string{})

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.PostV1PatientsIdLabs(c, id)
}

// PostV1Users operation middleware
func (siw *ServerInterfaceWrapper) PostV1Users(c *gin.Context) {

	c.Set(BearerAuthScopes, []string{})

	for _, middleware := range siw.HandlerMiddlewares {
		middleware(c)
		if c.IsAborted() {
			return
		}
	}

	siw.Handler.PostV1Users(c)
}

// GinServerOptions provides options for the Gin server.
type GinServerOptions struct {
	BaseURL      string
	Middlewares  []MiddlewareFunc
	ErrorHandler func(*gin.Context, error, int)
}

// RegisterHandlers creates http.Handler with routing matching OpenAPI spec.
func RegisterHandlers(router gin.IRouter, si ServerInterface) {
	RegisterHandlersWithOptions(router, si, GinServerOptions{})
}

// RegisterHandlersWithOptions creates http.Handler with additional options
func RegisterHandlersWithOptions(router gin.IRouter, si ServerInterface, options GinServerOptions) {
	errorHandler := options.ErrorHandler
	if errorHandler == nil {
		errorHandler = func(c *gin.Context, err error, statusCode int) {
			c.JSON(statusCode, gin.H{"msg": err.Error()})
		}
	}

	wrapper := ServerInterfaceWrapper{
		Handler:            si,
		HandlerMiddlewares: options.Middlewares,
		ErrorHandler:       errorHandler,
	}

	router.GET(options.BaseURL+"/", wrapper.Get)
	router.GET(options.BaseURL+"/docs", wrapper.GetDocs)
	router.GET(options.BaseURL+"/healthz", wrapper.GetHealthz)
	router.GET(options.BaseURL+"/readyz", wrapper.GetReadyz)
	router.DELETE(options.BaseURL+"/v1/me", wrapper.DeleteV1Me)
	router.GET(options.BaseURL+"/v1/me", wrapper.GetV1Me)
	router.PUT(options.BaseURL+"/v1/me", wrapper.PutV1Me)
	router.GET(options.BaseURL+"/v1/me/patients", wrapper.GetV1MePatients)
	router.GET(options.BaseURL+"/v1/patients", wrapper.GetV1Patients)
	router.POST(options.BaseURL+"/v1/patients", wrapper.PostV1Patients)
	router.GET(options.BaseURL+"/v1/patients/:id", wrapper.GetV1PatientsId)
	router.GET(options.BaseURL+"/v1/patients/:id/labs", wrapper.GetV1PatientsIdLabs)
	router.POST(options.BaseURL+"/v1/patients/:id/labs", wrapper.PostV1PatientsIdLabs)
	router.POST(options.BaseURL+"/v1/users", wrapper.PostV1Users)
}
